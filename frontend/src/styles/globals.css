@tailwind base;
@tailwind components;
@tailwind utilities;

/* ─── CSS Custom Properties ─────────────────────────────────────────────────── */
:root {
  --neon-green:  #00ff88;
  --neon-blue:   #00d4ff;
  --neon-red:    #ff3366;
  --neon-yellow: #ffaa00;
  --neon-purple: #aa66ff;
  --neon-cyan:   #00ffee;

  --dark-950: #06070d;
  --dark-900: #0a0a0f;
  --dark-800: #0d1117;
  --dark-700: #111827;
  --dark-600: #1a2235;
  --dark-500: #1e2d3d;
  --dark-400: #2d3748;
  --dark-300: #4a5568;

  --glass-bg:     rgba(255, 255, 255, 0.03);
  --glass-border: rgba(255, 255, 255, 0.06);
  --glass-blur:   16px;

  --sidebar-w: 56px;
  --header-h:  48px;
  --footer-h:  28px;
}

/* ─── Base ───────────────────────────────────────────────────────────────────── */
@layer base {
  * { box-sizing: border-box; }

  html { height: 100%; }

  body {
    @apply bg-dark-950 text-gray-100 font-sans;
    background-image:
      radial-gradient(ellipse at 15% 40%, rgba(0,212,255,0.04) 0%, transparent 55%),
      radial-gradient(ellipse at 85% 15%, rgba(0,255,136,0.04) 0%, transparent 55%),
      radial-gradient(ellipse at 50% 90%, rgba(170,102,255,0.03) 0%, transparent 50%);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar       { width: 4px; height: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.08);
    border-radius: 99px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: rgba(255,255,255,0.15);
  }

  /* Selection */
  ::selection {
    background: rgba(0,212,255,0.25);
    color: #fff;
  }

  /* Code blocks */
  pre, code {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
  }

  pre {
    @apply bg-dark-800 rounded-xl overflow-x-auto text-xs p-4;
    border: 1px solid rgba(255,255,255,0.05);
  }
}

/* ─── Components ─────────────────────────────────────────────────────────────── */
@layer components {

  /* ── Glass cards ── */
  .glass {
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur)) saturate(180%);
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(180%);
    border: 1px solid var(--glass-border);
  }

  .card-glass {
    @apply glass rounded-2xl p-4;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05);
  }

  .card {
    @apply bg-dark-700 border border-dark-400/60 rounded-2xl p-4;
    box-shadow: 0 4px 24px rgba(0,0,0,0.3);
  }

  .card-sm {
    @apply bg-dark-700 border border-dark-400/60 rounded-xl p-3;
  }

  /* ── Glow borders on hover ── */
  .card-hover-blue  { @apply transition-all duration-300 hover:border-neon-blue/40 hover:shadow-glow-blue; }
  .card-hover-green { @apply transition-all duration-300 hover:border-neon-green/40 hover:shadow-glow-green; }
  .card-hover-red   { @apply transition-all duration-300 hover:border-neon-red/40 hover:shadow-glow-red; }

  /* ── Severity badges ── */
  .badge {
    @apply inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-bold uppercase tracking-wide border;
  }
  .badge-critical { @apply badge bg-red-500/15 text-red-400 border-red-500/30; }
  .badge-high     { @apply badge bg-orange-500/15 text-orange-400 border-orange-500/30; }
  .badge-medium   { @apply badge bg-yellow-500/15 text-yellow-400 border-yellow-500/30; }
  .badge-low      { @apply badge bg-blue-500/15 text-blue-400 border-blue-500/30; }

  /* ── Status dots ── */
  .status-dot         { @apply w-1.5 h-1.5 rounded-full inline-block flex-shrink-0; }
  .status-dot-idle    { @apply status-dot bg-gray-500; }
  .status-dot-working { @apply status-dot bg-neon-blue; animation: ping-pulse 1.5s ease-in-out infinite; }
  .status-dot-done    { @apply status-dot bg-neon-green; }
  .status-dot-error   { @apply status-dot bg-neon-red; }

  /* ── Buttons ── */
  .btn {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-xl font-semibold text-sm
           border transition-all duration-200 cursor-pointer select-none;
  }
  .btn:active { transform: scale(0.97); }

  .btn-primary {
    @apply btn bg-neon-blue/10 hover:bg-neon-blue/20
           border-neon-blue/30 hover:border-neon-blue/60
           text-neon-blue;
  }
  .btn-danger {
    @apply btn bg-neon-red/10 hover:bg-neon-red/20
           border-neon-red/30 hover:border-neon-red/60
           text-neon-red;
  }
  .btn-success {
    @apply btn bg-neon-green/10 hover:bg-neon-green/20
           border-neon-green/30 hover:border-neon-green/60
           text-neon-green;
  }
  .btn-ghost {
    @apply btn bg-transparent hover:bg-dark-600
           border-transparent hover:border-dark-400
           text-gray-400 hover:text-gray-200;
  }
  .btn-simulate {
    @apply btn px-5 py-2.5
           bg-gradient-to-r from-neon-blue/20 to-neon-purple/20
           hover:from-neon-blue/30 hover:to-neon-purple/30
           border-neon-blue/40 hover:border-neon-blue/70
           text-white font-bold;
    box-shadow: 0 0 20px rgba(0,212,255,0.15);
  }
  .btn-simulate:hover {
    box-shadow: 0 0 30px rgba(0,212,255,0.3);
  }

  /* ── Nav items (sidebar) ── */
  .nav-item {
    @apply flex items-center justify-center w-10 h-10 rounded-xl
           text-gray-500 hover:text-gray-200 hover:bg-dark-600
           transition-all duration-200 cursor-pointer relative;
  }
  .nav-item.active {
    @apply text-neon-blue bg-neon-blue/10 border border-neon-blue/30;
  }
  .nav-item.active::before {
    content: '';
    position: absolute;
    left: -1px;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 60%;
    background: var(--neon-blue);
    border-radius: 0 2px 2px 0;
    box-shadow: 0 0 8px var(--neon-blue);
  }

  /* ── Terminal / log entries ── */
  .log-entry {
    @apply flex items-start gap-2 py-0.5 text-xs font-mono;
  }
  .log-info    { @apply text-gray-400; }
  .log-success { @apply text-neon-green; }
  .log-error   { @apply text-neon-red; }
  .log-warning { @apply text-yellow-400; }
  .log-mcp     { @apply text-neon-blue; }
  .log-ts      { @apply text-gray-600 flex-shrink-0; }

  /* ── Diff ── */
  .diff-added   { @apply text-neon-green bg-neon-green/5; }
  .diff-removed { @apply text-neon-red bg-neon-red/5; }
  .diff-context { @apply text-gray-600; }

  /* ── Skeleton loading ── */
  .skeleton {
    @apply bg-dark-600 rounded animate-pulse;
  }

  /* ── Progress bar ── */
  .progress-track {
    @apply h-1 rounded-full bg-dark-600 overflow-hidden;
  }
  .progress-fill {
    @apply h-full rounded-full transition-all duration-700;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-green));
  }

  /* ── Metric value ── */
  .metric-value {
    @apply text-2xl font-bold font-mono tracking-tight;
  }
  .metric-label {
    @apply text-xs text-gray-500 uppercase tracking-wider;
  }

  /* ── Section header ── */
  .section-title {
    @apply text-xs font-bold uppercase tracking-widest text-gray-500;
  }
}

/* ─── Utilities ──────────────────────────────────────────────────────────────── */
@layer utilities {
  /* Glow text */
  .text-glow-green  { text-shadow: 0 0 12px rgba(0,255,136,0.8),  0 0 24px rgba(0,255,136,0.3); }
  .text-glow-blue   { text-shadow: 0 0 12px rgba(0,212,255,0.8),  0 0 24px rgba(0,212,255,0.3); }
  .text-glow-red    { text-shadow: 0 0 12px rgba(255,51,102,0.8),  0 0 24px rgba(255,51,102,0.3); }
  .text-glow-yellow { text-shadow: 0 0 12px rgba(255,170,0,0.8),  0 0 24px rgba(255,170,0,0.3); }
  .text-glow-purple { text-shadow: 0 0 12px rgba(170,102,255,0.8), 0 0 24px rgba(170,102,255,0.3); }

  /* Glow boxes */
  .glow-green  { box-shadow: 0 0 15px rgba(0,255,136,0.35),  0 0 30px rgba(0,255,136,0.12); }
  .glow-blue   { box-shadow: 0 0 15px rgba(0,212,255,0.35),  0 0 30px rgba(0,212,255,0.12); }
  .glow-red    { box-shadow: 0 0 15px rgba(255,51,102,0.35),  0 0 30px rgba(255,51,102,0.12); }
  .glow-yellow { box-shadow: 0 0 15px rgba(255,170,0,0.35),  0 0 30px rgba(255,170,0,0.12); }
  .glow-purple { box-shadow: 0 0 15px rgba(170,102,255,0.35), 0 0 30px rgba(170,102,255,0.12); }

  /* Neon borders */
  .border-glow-blue   { border-color: rgba(0,212,255,0.5); box-shadow: inset 0 0 10px rgba(0,212,255,0.05); }
  .border-glow-green  { border-color: rgba(0,255,136,0.5); box-shadow: inset 0 0 10px rgba(0,255,136,0.05); }

  /* Shimmer text */
  .shimmer-text {
    background: linear-gradient(90deg, #888 0%, #fff 45%, #fff 55%, #888 100%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: shimmer 2.5s linear infinite;
  }

  /* Truncate multi-line */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Monospace numbers (prevent layout shift) */
  .tabular-nums { font-variant-numeric: tabular-nums; }
}

/* ─── Scan line ──────────────────────────────────────────────────────────────── */
.scan-line {
  position: absolute;
  left: 0; right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent 0%, rgba(0,212,255,0.7) 50%, transparent 100%);
  animation: scan 2.5s linear infinite;
  pointer-events: none;
  z-index: 10;
}

/* ─── MCP Arrow shine ────────────────────────────────────────────────────────── */
.mcp-shine {
  position: relative;
  overflow: hidden;
}
.mcp-shine::after {
  content: '';
  position: absolute;
  top: 0; left: -100%;
  width: 60%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(0,212,255,0.15), transparent);
  animation: mcp-shine-move 2s ease-in-out infinite;
}
@keyframes mcp-shine-move {
  0%   { left: -60%; }
  100% { left: 110%; }
}

/* ─── Ping pulse (for active status dot) ───────────────────────────────────── */
@keyframes ping-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50%      { opacity: 0.6; transform: scale(1.3); }
}

/* ─── Incident flash-in ──────────────────────────────────────────────────────── */
.incident-flash {
  animation: flash-red 1.5s ease-out forwards;
}

/* ─── Resolve flash ──────────────────────────────────────────────────────────── */
.resolve-flash {
  animation: resolve-flash 2s ease-out forwards;
}

/* ─── MCP call row highlight ────────────────────────────────────────────────── */
.mcp-row-enter {
  animation: fade-in 0.2s ease-out, slide-up 0.2s ease-out;
}

/* ─── Sidebar layout helpers ────────────────────────────────────────────────── */
.app-layout {
  display: grid;
  grid-template-columns: var(--sidebar-w) 1fr;
  grid-template-rows: var(--header-h) 1fr var(--footer-h);
  grid-template-areas:
    "sidebar header"
    "sidebar main"
    "sidebar footer";
  height: 100vh;
  overflow: hidden;
}

.app-sidebar { grid-area: sidebar; }
.app-header  { grid-area: header; }
.app-main    { grid-area: main; overflow-y: auto; }
.app-footer  { grid-area: footer; }

/* ─── Stat card ring ────────────────────────────────────────────────────────── */
.ring-progress {
  transform: rotate(-90deg);
  transform-origin: center;
}

/* ─── Agent pipeline connector ──────────────────────────────────────────────── */
.pipeline-connector {
  position: relative;
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, rgba(0,212,255,0.3), rgba(0,255,136,0.3));
}
.pipeline-connector.active {
  background: linear-gradient(90deg, var(--neon-blue), var(--neon-green));
  box-shadow: 0 0 8px rgba(0,212,255,0.5);
}
.pipeline-particle {
  position: absolute;
  top: -2px;
  width: 5px; height: 5px;
  border-radius: 50%;
  background: var(--neon-blue);
  box-shadow: 0 0 6px var(--neon-blue);
  animation: particle 1.8s ease-in-out infinite;
}

/* ─── Tooltip ─────────────────────────────────────────────────────────────────── */
[data-tooltip] {
  position: relative;
}
[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--dark-600);
  border: 1px solid rgba(255,255,255,0.08);
  color: #e2e8f0;
  font-size: 11px;
  font-family: 'JetBrains Mono', monospace;
  padding: 4px 8px;
  border-radius: 6px;
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.15s;
  z-index: 50;
}
[data-tooltip]:hover::after { opacity: 1; }

/* ─── Scrollbar thin (for panels) ──────────────────────────────────────────── */
.scrollbar-thin::-webkit-scrollbar      { width: 3px; }
.scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.06); border-radius: 99px; }
